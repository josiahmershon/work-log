## Work Log Entry: 2025-11-26

Clock in: 9:15 a.m.
Clock out: 3:47 p.m.

### Summary

feat: Enhance chat history management in query processing

- Introduced ChatHistoryEntry model to structure conversation history with roles and content.
- Updated QueryRequest to include a history field for tracking user-assistant interactions.
- Implemented logic to clean and limit history entries based on a configurable maximum.
- Modified response generation functions to incorporate conversation history for improved context in responses.
- Enhanced frontend to manage and send conversation history with each query, ensuring a seamless user experience.

feat: Implement source filtering based on response content

- Added filter_sources_by_response function to retain only sources explicitly referenced in the response text, while always preserving attachment sources.
- Updated process_query_common to utilize the new filtering logic, enhancing the relevance of sources returned in responses.